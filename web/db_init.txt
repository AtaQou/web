-- Δημιουργία της βάσης δεδομένων
CREATE DATABASE IF NOT EXISTS web;

-- Χρήση της βάσης δεδομένων
USE web;

CREATE TABLE vehicles (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50),
    latitude DOUBLE,
    longitude DOUBLE,
    cargo VARCHAR(255),
    status VARCHAR(50)
);

CREATE TABLE requests (
    id INT AUTO_INCREMENT PRIMARY KEY,
    citizen_name VARCHAR(100),
    citizen_phone VARCHAR(15),
    latitude DOUBLE,
    longitude DOUBLE,
    item_type VARCHAR(255),
    quantity INT,
    request_date DATETIME,
    vehicle_id INT,
    FOREIGN KEY (vehicle_id) REFERENCES vehicles(id)
);

CREATE TABLE offers (
    id INT AUTO_INCREMENT PRIMARY KEY,
    citizen_name VARCHAR(100),
    citizen_phone VARCHAR(15),
    latitude DOUBLE,
    longitude DOUBLE,
    item_type VARCHAR(255),
    quantity INT,
    offer_date DATETIME,
    vehicle_id INT,
    FOREIGN KEY (vehicle_id) REFERENCES vehicles(id)
);


-- Δημιουργία του πίνακα για τους χρήστες
CREATE TABLE IF NOT EXISTS users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,
    role ENUM('administrator', 'rescuer', 'citizen') NOT NULL,
    name VARCHAR(100) NOT NULL,
    phone VARCHAR(15) NOT NULL,
    location POINT,  -- Αποθήκευση γεωγραφικής θέσης
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS categories (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE,
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS inventory (
    id INT AUTO_INCREMENT PRIMARY KEY,
    category_id INT,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    quantity INT NOT NULL DEFAULT 0,
    location POINT,  -- Location of the warehouse or vehicle
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE CASCADE
);



INSERT INTO users (username, password_hash, role, name, phone, location) 
VALUES (
    'admin', 
    '12345', 
    'administrator', 
    'EGW', 
    '1234567890', 
    POINT(37.9838, 23.7275)  -- Παράδειγμα συντεταγμένων για την Αθήνα
);
SELECT * FROM users;

SHOW TABLES; 
select * from categories;
select * from inventory;
DELETE FROM categories where id=11;

ALTER TABLE requests ADD COLUMN status ENUM('pending', 'completed') DEFAULT 'pending';
ALTER TABLE offers ADD COLUMN status ENUM('pending', 'completed') DEFAULT 'pending';

-- Creating a table for base location
CREATE TABLE base_location (
    id INT AUTO_INCREMENT PRIMARY KEY,
    latitude DOUBLE,
    longitude DOUBLE
);

INSERT INTO vehicles (username, latitude, longitude, cargo, status) VALUES
('Vehicle1', 37.9838, 23.7275, 'Medical Supplies', 'active'),
('Vehicle2', 37.9848, 23.7285, 'Food Supplies', 'active'),
('Vehicle3', 37.9828, 23.7265, 'Water Bottles', 'inactive');

INSERT INTO requests (citizen_name, citizen_phone, item_type, quantity, latitude, longitude, request_date, status) VALUES
('John Doe', '1234567890', 'Blankets', 10, 37.9868, 23.7295, '2024-08-12', 'pending'),
('Jane Smith', '0987654321', 'First Aid Kits', 5, 37.9818, 23.7255, '2024-08-10', 'pending');

INSERT INTO offers (citizen_name, citizen_phone, item_type, quantity, latitude, longitude, offer_date, status) VALUES
('Alice Johnson', '1122334455', 'Canned Food', 20, 37.9858, 23.7265, '2024-08-11', 'pending'),
('Bob Brown', '5566778899', 'Bottled Water', 50, 37.9848, 23.7275, '2024-08-12', 'pending');

INSERT INTO base_location (latitude, longitude) VALUES
(37.9830, 23.7270);